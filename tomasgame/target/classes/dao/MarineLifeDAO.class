// Source code is decompiled from a .class file using FernFlower decompiler (from Intellij IDEA).
package dao;

import java.io.ByteArrayInputStream;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import javafx.scene.image.Image;
import model.Environment;
import model.MarineLife;

public class MarineLifeDAO {
   private static final String SELECT_ALL = "SELECT id_marinelife, name, classification, points, description, id_image FROM marinelife";

   public MarineLifeDAO() {
   }

   public static List<MarineLife> getAllMarineLife() {
      List<MarineLife> marineLifeList = new ArrayList();

      try {
         Throwable var1 = null;
         Object var2 = null;

         try {
            Connection con = BaseDAO.getCon();

            try {
               PreparedStatement st = con.prepareStatement("SELECT id_marinelife, name, classification, points, description, id_image FROM marinelife");

               try {
                  ResultSet rs = st.executeQuery();

                  try {
                     while(rs.next()) {
                        MarineLife marineLife = new MarineLife(rs.getInt("id_marinelife"), rs.getString("name"), rs.getString("classification"), rs.getInt("points"), rs.getString("description"), rs.getInt("id_image"));
                        marineLifeList.add(marineLife);
                     }
                  } finally {
                     if (rs != null) {
                        rs.close();
                     }

                  }
               } catch (Throwable var28) {
                  if (var1 == null) {
                     var1 = var28;
                  } else if (var1 != var28) {
                     var1.addSuppressed(var28);
                  }

                  if (st != null) {
                     st.close();
                  }

                  throw var1;
               }

               if (st != null) {
                  st.close();
               }
            } catch (Throwable var29) {
               if (var1 == null) {
                  var1 = var29;
               } else if (var1 != var29) {
                  var1.addSuppressed(var29);
               }

               if (con != null) {
                  con.close();
               }

               throw var1;
            }

            if (con != null) {
               con.close();
            }
         } catch (Throwable var30) {
            if (var1 == null) {
               var1 = var30;
            } else if (var1 != var30) {
               var1.addSuppressed(var30);
            }

            throw var1;
         }
      } catch (SQLException var31) {
         System.err.println("Error fetching marine life: " + var31.getMessage());
      }

      return marineLifeList;
   }

   public static int getMarineLifePoints(int marineLifeId) {
      int points = 0;
      ResultSet rs = null;
      PreparedStatement st = null;
      Connection con = null;

      try {
         con = BaseDAO.getCon();
         String query = "SELECT points FROM marinelife WHERE id_marinelife = ?";
         st = con.prepareStatement(query);
         st.setInt(1, marineLifeId);
         rs = st.executeQuery();
         if (rs.next()) {
            points = rs.getInt("points");
         }
      } catch (SQLException var14) {
         var14.printStackTrace();
      } finally {
         try {
            if (rs != null) {
               rs.close();
            }

            if (st != null) {
               st.close();
            }
         } catch (SQLException var13) {
            var13.printStackTrace();
         }

         BaseDAO.closeCon(con);
      }

      return points;
   }

   public static MarineLife getMarineLifeById(int id) {
      String query = "SELECT id_marinelife, name, classification, points, description, id_image FROM marinelife WHERE m.id_marinelife = ?";

      try {
         Throwable var2 = null;
         Object var3 = null;

         try {
            Connection con = BaseDAO.getCon();

            Object var10000;
            label732: {
               try {
                  PreparedStatement st = con.prepareStatement(query);

                  try {
                     st.setInt(1, id);
                     Throwable var6 = null;
                     Object var7 = null;

                     try {
                        ResultSet rs;
                        var10000 = rs = st.executeQuery();

                        try {
                           var10000 = rs.next();
                           if (var10000 != false) {
                              byte[] imageData = rs.getBytes("data");
                              Image image = null;
                              if (imageData != null) {
                                 image = new Image(new ByteArrayInputStream(imageData));
                              }

                              var10000 = new MarineLife(rs.getInt("id_marinelife"), rs.getString("name"), rs.getString("classification"), rs.getInt("points"), rs.getString("description"), rs.getInt("id_image"), (Environment)null, image);
                              break label732;
                           }
                        } finally {
                           if (rs != null) {
                              rs.close();
                           }

                        }
                     } catch (Throwable var42) {
                        if (var6 == null) {
                           var6 = var42;
                        } else if (var6 != var42) {
                           var6.addSuppressed(var42);
                        }

                        throw var6;
                     }
                  } finally {
                     if (st != null) {
                        st.close();
                     }

                  }
               } catch (Throwable var44) {
                  if (var2 == null) {
                     var2 = var44;
                  } else if (var2 != var44) {
                     var2.addSuppressed(var44);
                  }

                  if (con != null) {
                     con.close();
                  }

                  throw var2;
               }

               if (con != null) {
                  con.close();
               }

               return null;
            }

            if (con != null) {
               con.close();
            }

            return (MarineLife)var10000;
         } catch (Throwable var45) {
            if (var2 == null) {
               var2 = var45;
            } else if (var2 != var45) {
               var2.addSuppressed(var45);
            }

            throw var2;
         }
      } catch (SQLException var46) {
         System.err.println("Error fetching marine life by ID: " + var46.getMessage());
         return null;
      }
   }
}

